<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Generator</title>
    <script>
        function updateQRCode() {
            fetch('/get_qr')
                .then(response => {
                    if (!response.ok) {
                        throw new Error("QR code has expired!");
                    }
                    return response.blob();
                })
                .then(imageBlob => {
                    const imageObjectURL = URL.createObjectURL(imageBlob);
                    document.getElementById('qrCode').src = imageObjectURL;
                })
                .catch(error => {
                    document.getElementById('qrCode').alt = error.message;
                    document.getElementById('qrCode').src = '';
                });
        }

        function startQRCodeRotation() {
            updateQRCode();
            setInterval(updateQRCode, 15000); // Refresh QR code every 15 seconds
        }
    </script>
</head>
<body onload="startQRCodeRotation()">
    <h1>Dynamic QR Code Generator</h1>
    <img id="qrCode" alt="QR Code will appear here" />
</body>
</html>
